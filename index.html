<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
         content="OptMark: Robust Multi-bit Diffusion Watermarking via Inference Time Optimization - A novel approach to secure image watermarking using diffusion models">
  <meta name="keywords" content="watermarking, diffusion models, computer vision, security, machine learning, inference time optimization">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>OptMark: Robust Multi-bit Diffusion Watermarking via Inference Time Optimization</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" type="image/x-icon" href="static/images/favicon.ico">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

  <nav class="navbar" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>
    <div class="navbar-menu">
      <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      </div>
    </div>
  </nav>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">
              OptMark: Robust Multi-bit Diffusion Watermarking via Inference Time Optimization
            </h1>
            <div class="is-size-5 publication-authors">
              <span class="author-block">
                <a href="#" target="_blank">Jiazheng Xing</a><sup>1,2,*</sup>,</span>
              <span class="author-block">
                <a href="#" target="_blank">Hai Ci</a><sup>2,*</sup>,</span>
              <span class="author-block">
                <a href="#" target="_blank">Hongbin Xu</a><sup>2</sup>,</span>
              <span class="author-block">
                <a href="#" target="_blank">Hangjie Yuan</a><sup>1</sup>,</span>
              <span class="author-block">
                <a href="#" target="_blank">Yong Liu</a><sup>1,†</sup>,</span>
              <span class="author-block">
                <a href="#" target="_blank">Mike Zheng Shou</a><sup>2</sup></span>
            </div>

            <div class="is-size-5 publication-authors">
              <span class="author-block"><sup>1</sup>Zhejiang University</span><br>
              <span class="author-block"><sup>2</sup>Show Lab, National University of Singapore</span><br>
              <span class="eql-cntrb"><small><sup>*</sup>Equal Contribution, <sup>†</sup>Corresponding Author</small></span>
            </div>
  


            <div class="column has-text-centered">
              <div class="publication-links">
                <!-- PDF Link. -->
                <span class="link-block">
                  <a href="#"
                     class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <i class="fas fa-file-pdf"></i>
                    </span>
                    <span>Paper</span>
                  </a>
                </span>
                <span class="link-block">
                  <a href="#"
                     class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <i class="ai ai-arxiv"></i>
                    </span>
                    <span>arXiv</span>
                  </a>
                </span>

                <span class="link-block">
                  <a href="#"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>

                <span class="link-block">
                  <a href="mailto:jiazhengxing@zju.edu.cn" target="_blank"
                      class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                          <i class="fas fa-envelope"></i>
                      </span>
                      <span>Contact</span>
                  </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>



<!-- <section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item item-steve">
          <img src="static/images/case1.png" alt="ap-clip" />
        </div>
        <div class="item item-steve">
          <img src="static/images/case2.png" alt="ap-clip" />
        </div>
        <div class="item item-steve">
          <img src="static/images/case3.png" alt="ap-clip" />
        </div>
        <div class="item item-steve">
          <img src="static/images/case4.png" alt="ap-clip" />
        </div>
        <div class="item item-steve">
          <img src="static/images/case5.png" alt="ap-clip" />
        </div>
        <div class="item item-steve">
          <img src="static/images/case6.png" alt="ap-clip" />
        </div>
      </div>
    </div>
  </div>
</section> -->


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Watermarking diffusion-generated images is crucial for copyright protection and user tracking.
            However, current diffusion watermarking methods face significant limitations: zero-bit watermarking systems lack the capacity for large-scale user tracking, while multi-bit methods are highly sensitive to certain image transformations or generative attacks, resulting in a lack of comprehensive robustness.
            In this paper, we propose <strong>OptMark</strong>, an optimization-based approach that embeds a robust multi-bit watermark into the intermediate latents of the diffusion denoising process. OptMark strategically inserts a structural watermark early to resist generative attacks and a detail watermark late to withstand image transformations, with tailored regularization terms to preserve image quality and ensure imperceptibility.
            To address the challenge of memory consumption growing linearly with the number of denoising steps during optimization, OptMark incorporates adjoint gradient methods, reducing memory usage from O(N) to O(1). Experimental results demonstrate that OptMark achieves invisible multi-bit watermarking while ensuring robust resilience against valuemetric transformations, geometric transformations, editing, and regeneration attacks.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <section class="section">
      <div class="container is-max-desktop">
        <!-- Environment Infrastructure. -->
        <h2 class="title is-3 has-text-centered">Methods</h2>
        <div class="content has-text-justified">
          <img src="static/images/main.png" width="100%" alt="OptMark Method Overview" class="responsive-image">
          <md-block>The robust watermark is embedded into the diffusion latent space during the generation process through inference time optimization. In the Decoding phase, the watermark embedding is extracted using a pre-trained message decoder, and the secret message is retrieved by comparing the decoded watermark embedding against a predefined key carrier.</md-block>
          <img src="static/images/message_embed.png" width="100%" alt="OptMark Message Embedding" class="responsive-image">
          <md-block>OptMark’s imprinting process consists of two sequential stages: first, a structure watermark is injected into the initial latent state of generation; then, a detail watermark is embedded at an intermediate timestep. These complementary watermarks work in concert to maximize overall robustness.</md-block>
        </div>
        <!--/ Environment Infrastructure. -->
      </div>
    </section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Environment Infrastructure. -->
      <h2 class="title is-3 has-text-centered">Robustness Performance Comparison on Various Attacks</h2>

      <div class="tabs is-centered is-boxed" style="margin-bottom: 1rem;">
        <ul id="robustness-tabs">
          <li class="is-active" data-target="tab-multibit"><a>Multi-bit Comparison</a></li>
          <li data-target="tab-zerobit"><a>Zero-bit Comparison</a></li>
        </ul>
      </div>

      <div id="tab-multibit">
        <div class="table-container">
          <table class="table is-fullwidth is-striped has-text-centered">
            <thead>
              <tr>
                <th>Method</th>
                <th colspan="2">None</th>
                <th colspan="2">Geometric</th>
                <th colspan="2">Valuemetric</th>
                <th colspan="2">Editing</th>
                <th colspan="2">Regeneration</th>
                <th colspan="2">Average</th>
              </tr>
              <tr>
                <th></th>
                <th>Bit Acc.</th>
                <th>TPR</th>
                <th>Bit Acc.</th>
                <th>TPR</th>
                <th>Bit Acc.</th>
                <th>TPR</th>
                <th>Bit Acc.</th>
                <th>TPR</th>
                <th>Bit Acc.</th>
                <th>TPR</th>
                <th>Bit Acc.</th>
                <th>TPR</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>DwtDct</td>
                <td>0.828</td>
                <td>0.576</td>
                <td class="has-text-danger">0.501</td>
                <td class="has-text-danger">0.000</td>
                <td class="has-text-danger">0.509</td>
                <td class="has-text-danger">0.363</td>
                <td class="has-text-danger">0.719</td>
                <td class="has-text-danger">0.256</td>
                <td class="has-text-danger">0.494</td>
                <td class="has-text-danger">0.000</td>
                <td class="has-text-danger">0.573</td>
                <td class="has-text-danger">0.125</td>
              </tr>
              <tr>
                <td>DwtDctSvd</td>
                <td><strong>1.000</strong></td>
                <td><strong>1.000</strong></td>
                <td class="has-text-danger">0.468</td>
                <td class="has-text-danger">0.000</td>
                <td class="has-text-danger">0.701</td>
                <td class="has-text-danger">0.405</td>
                <td>0.837</td>
                <td>0.671</td>
                <td class="has-text-danger">0.605</td>
                <td class="has-text-danger">0.022</td>
                <td class="has-text-danger">0.679</td>
                <td class="has-text-danger">0.340</td>
              </tr>
              <tr>
                <td>RivaGAN</td>
                <td>0.994</td>
                <td>0.994</td>
                <td class="has-text-danger">0.742</td>
                <td class="has-text-danger">0.492</td>
                <td>0.974</td>
                <td>0.966</td>
                <td>0.914</td>
                <td>0.775</td>
                <td class="has-text-danger">0.570</td>
                <td class="has-text-danger">0.003</td>
                <td class="has-text-danger">0.835</td>
                <td class="has-text-danger">0.641</td>
              </tr>
              <tr>
                <td>SSL Watermark</td>
                <td><strong>1.000</strong></td>
                <td><strong>1.000</strong></td>
                <td>0.996</td>
                <td>0.998</td>
                <td>0.989</td>
                <td>0.994</td>
                <td>0.922</td>
                <td>0.750</td>
                <td class="has-text-danger">0.596</td>
                <td class="has-text-danger">0.005</td>
                <td>0.906</td>
                <td>0.763</td>
              </tr>
              <tr>
                <td>Stable Signature</td>
                <td>0.995</td>
                <td>0.998</td>
                <td>0.810</td>
                <td>0.496</td>
                <td>0.824</td>
                <td>0.724</td>
                <td class="has-text-danger">0.253</td>
                <td class="has-text-danger">0.498</td>
                <td class="has-text-danger">0.605</td>
                <td class="has-text-danger">0.011</td>
                <td class="has-text-danger">0.757</td>
                <td class="has-text-danger">0.509</td>
              </tr>
              <tr>
                <td>Gaussian Shading</td>
                <td><strong>1.000</strong></td>
                <td><strong>1.000</strong></td>
                <td class="has-text-danger">0.634</td>
                <td class="has-text-danger">0.250</td>
                <td><strong>0.998</strong></td>
                <td>0.997</td>
                <td>0.870</td>
                <td>0.750</td>
                <td><strong>0.986</strong></td>
                <td><strong>0.958</strong></td>
                <td>0.880</td>
                <td>0.756</td>
              </tr>
              <tr>
                <td>AquaLoRA</td>
                <td>0.963</td>
                <td>0.979</td>
                <td class="has-text-danger">0.690</td>
                <td class="has-text-danger">0.271</td>
                <td>0.954</td>
                <td>0.973</td>
                <td>0.858</td>
                <td>0.702</td>
                <td>0.930</td>
                <td>0.955</td>
                <td>0.866</td>
                <td>0.741</td>
              </tr>
              <tr class="has-background-success-light">
                <td><strong>OptMark (ours)</strong></td>
                <td><strong>1.000</strong></td>
                <td><strong>1.000</strong></td>
                <td><strong>0.998</strong></td>
                <td><strong>1.000</strong></td>
                <td><strong>0.998</strong></td>
                <td><strong>1.000</strong></td>
                <td><strong>0.990</strong></td>
                <td><strong>0.979</strong></td>
                <td>0.923</td>
                <td>0.872</td>
                <td><strong>0.983</strong></td>
                <td><strong>0.972</strong></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div id="tab-zerobit" style="display: none;">
        <div class="table-container">
          <table class="table is-fullwidth is-striped has-text-centered">
            <thead>
              <tr>
                <th>Method</th>
                <th>None</th>
                <th>Geometric</th>
                <th>Valuemetric</th>
                <th>Editing</th>
                <th>Regeneration</th>
                <th>Average</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Tree-Ring</td>
                <td><strong>1.000</strong></td>
                <td>0.773</td>
                <td>0.970</td>
                <td>0.765</td>
                <td>0.953</td>
                <td>0.874</td>
              </tr>
              <tr>
                <td>RingID</td>
                <td><strong>1.000</strong></td>
                <td>0.750</td>
                <td>0.999</td>
                <td>0.717</td>
                <td>0.814</td>
                <td>0.841</td>
              </tr>
              <tr>
                <td>WIND</td>
                <td><strong>1.000</strong></td>
                <td>0.985</td>
                <td>0.976</td>
                <td>0.748</td>
                <td><strong>1.000</strong></td>
                <td>0.930</td>
              </tr>
              <tr class="has-background-success-light">
                <td><strong>OptMark (ours)</strong></td>
                <td><strong>1.000</strong></td>
                <td><strong>1.000</strong></td>
                <td><strong>1.000</strong></td>
                <td><strong>1.000</strong></td>
                <td>0.993</td>
                <td><strong>0.999</strong></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <script>
        (function(){
          var tabs = document.querySelectorAll('#robustness-tabs li');
          tabs.forEach(function(tab){
            tab.addEventListener('click', function(){
              tabs.forEach(function(t){ t.classList.remove('is-active'); });
              tab.classList.add('is-active');
              var target = tab.getAttribute('data-target');
              document.getElementById('tab-multibit').style.display = target === 'tab-multibit' ? '' : 'none';
              document.getElementById('tab-zerobit').style.display = target === 'tab-zerobit' ? '' : 'none';
            });
          });
        })();
      </script>
      <p class="has-text-centered" style="margin-top: 1rem; font-size: 0.9rem;">
        <strong>Bold</strong> indicates best performance, <span class="has-text-danger">red text</span> indicates poor performance
      </p>
    </div>
    <!--/ Environment Infrastructure. -->
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <h2 class="title is-3 has-text-centered">Image Quality Comparison</h2>
      <h3 class="title is-4 has-text-centered" style="margin-top: 1.5rem;">Quantitative Comparison of Watermarked Image Quality</h3>
      <div class="table-container">
        <table class="table is-fullwidth is-striped has-text-centered">
          <thead>
            <tr>
              <th>Method</th>
              <th>FID ↓</th>
              <th>CLIP Score ↑</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>w/o watermark</td>
              <td>124.309</td>
              <td>0.3686</td>
            </tr>
            <tr>
              <td>SSL Watermark</td>
              <td>128.053</td>
              <td>0.3555</td>
            </tr>
            <tr>
              <td>Gaussian Shading</td>
              <td>127.756</td>
              <td><strong>0.3646</strong></td>
            </tr>
            <tr class="has-background-success-light">
              <td><strong>OptMark (ours)</strong></td>
              <td><strong>127.378</strong></td>
              <td>0.3630</td>
            </tr>
          </tbody>
        </table>
      </div>
      <p class="has-text-centered" style="margin-top: 0.5rem; font-size: 0.9rem;">
        Lower FID is better; higher CLIP Score is better. Bold indicates the best per column.
      </p>
      <h3 class="title is-4 has-text-centered" style="margin-top: 1.5rem;">Qualitative Comparison of Watermarked Image Quality</h3>
      <div class="content has-text-justified">
        <img src="static/images/result.png" width="100%" alt="OptMark Results" class="responsive-image">
      </div>
    </div>
  </div>
</section>

<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{xing2024optmark,
      title={OptMark: Robust Multi-bit Diffusion Watermarking via Inference Time Optimization},
      author={Xing, Jiazheng and Ci, Hai and Xu, Hongbin and Yuan, Hangjie and Liu, Yong and Shou, Mike Zheng},
      journal={arXiv preprint},
      year={2024}
    }</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>